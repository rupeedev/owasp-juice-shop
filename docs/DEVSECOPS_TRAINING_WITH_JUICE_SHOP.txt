================================================================================
DEVSECOPS PIPELINE WITH CLAUDE CODE CLI + OWASP JUICE SHOP
ENHANCED SECURITY TRAINING - 3-4 HOUR SESSION

  ğŸ“ Training Value Proposition

  Trainees will:
  1. Master pipeline evolution: Simple â†’ Secure â†’ Mature (real-world approach)
  2. Deploy working pipeline FIRST, then enhance (no complexity paralysis)
  3. Set up local Kubernetes cluster with Kind (production-like environment)
  4. Deploy GitHub Actions self-hosted runner in Kubernetes
  5. Automate K8s deployment with intelligent slash commands
  6. Fix common deployment issues (kubectl auto-install, port mappings)
  7. Complete CI/CD automation: git push â†’ GitHub Actions â†’ Deploy to K8s
  8. Exploit vulnerabilities in Juice Shop (understand attacker mindset)
  9. Analyze vulnerable code with Claude Code CLI
  10. Build complete DevSecOps pipeline incrementally
  11. Automate security scanning and workflows
  12. Use slash commands for operational automation

  ğŸ“Š Complete Training Flow

  Real-World Pipeline Evolution: Simple â†’ Secure â†’ Mature

  â”œâ”€â”€ Part 1: Introduction & Setup
  â”‚   â”œâ”€â”€ STEP 1: /init-context-files - Context preservation system
  â”‚   â”œâ”€â”€ STEP 2: /doc-generator - Generate project documentation
  â”‚   â”œâ”€â”€ STEP 3: /update-doc-refs - Update CLAUDE.md index
  â”‚  
  â”‚
  â”œâ”€â”€ Part 2: Claude Code CLI - Memory, Context & Automation
  â”‚   â”œâ”€â”€ DEMO 1: Context files & memory preservation
  â”‚   â”‚   â””â”€â”€ Show context files, interactive reading, explain 200K token window
  â”‚   â”œâ”€â”€ DEMO 2: /update-session-handoff automation
  â”‚   â”‚   â””â”€â”€ Automated session capture, update all context files
  â”‚
  â”œâ”€â”€ Part 3: Deploy Simple Pipeline First!
  â”‚   â”œâ”€ /simple-pipeline-setup
  â”‚   â”‚   What You'll Build:
  â”‚   â”‚   â€¢ Basic 3-stage pipeline (Lint â†’ Test â†’ Build)
  â”‚   â”‚   â€¢ Extend with Docker Hub push stage
  â”‚   â”‚   â€¢ Working CI/CD foundation (4 stages total)
  â”‚   â”œâ”€â”€ Pipeline Stages:
  â”‚   â”‚   1. Lint - Code quality checks (yamllint, npm run lint
  â”‚   â”‚   2. Test - Run test suite (npm test)
  â”‚   â”‚   3. Build - Docker image build
  â”‚   â”‚   4. Push to Docker Hub - Automated image push
  â”‚
  â”œâ”€â”€ Part 4: Local K8s Cluster with Kind + Automated Deployment
  â”‚   â”œâ”€â”€ Using Slash Commands: /kind-k8s-setup & /deploy-app-to-k8s-cluster
  â”‚   â”œâ”€â”€ Phase 1: Cluster Setup - /kind-k8s-setup
  â”‚   â”‚   â””â”€â”€ Steps 1-11: Cluster Infrastructure
  â”‚   â”‚       â€¢ Auto-detect OS (macOS/Linux/Windows)
  â”‚   â”‚       â€¢ Install Kind and kubectl
  â”‚   â”‚       â€¢ Create 3-node cluster (1 control plane + 2 workers)
  â”‚   â”‚       â€¢ Deploy Kube-ops-view for monitoring
  â”‚   â”‚       â€¢ Set up port forwarding (localhost:8080)
  â”‚   â”‚       â€¢ Validate cluster health
  â”‚   â”‚       â€¢ Test with sample deployment
  â”‚   â”‚       â€¢ Create GitHub PAT for runner
  â”‚   â”‚       â€¢ Store credentials in K8s secret
  â”‚   â”‚       â€¢ Deploy GitHub Actions runner pod
  â”‚   â”‚       â€¢ Verify runner in GitHub UI
  â”‚   â”‚
  â”‚   â”œâ”€â”€ Phase 2: Intelligent Deployment - /deploy-app-to-k8s-cluster
  â”‚   â”‚   â””â”€â”€ Auto-Detection Features:
  â”‚   â”‚       â€¢ Parse GitHub Actions workflow for Docker image
  â”‚   â”‚       â€¢ Extract container port from Dockerfile
  â”‚   â”‚       â€¢ Detect Kind cluster and parse config
  â”‚   â”‚       â€¢ Find extraPortMappings (e.g., 30080, 30443)
  â”‚   â”‚       â€¢ Identify self-hosted runner usage
  â”‚   â”‚   â””â”€â”€ Deployment Process (8 Steps):
  â”‚   â”‚       1. Show auto-detected configuration
  â”‚   â”‚       2. Ask only for missing info (replicas, resources)
  â”‚   â”‚       3. Create K8s manifests (deployment.yaml, service.yaml)
  â”‚   â”‚       4. Deploy to cluster and verify
  â”‚   â”‚       5. Extend GitHub Actions workflow
  â”‚   â”‚       6. Add kubectl auto-installation step
  â”‚   â”‚       7. Create deployment documentation
  â”‚   â”‚       8. Test end-to-end deployment
  â”‚   â”‚
  â”‚   â”œâ”€â”€ Key Features:
  â”‚   â”‚   â€¢ 3-node Kubernetes cluster (production-like)
  â”‚   â”‚   â€¢ Kube-ops-view visual monitoring (http://localhost:8080)
  â”‚       â€¢ Juice Shop deployed and accessible at http://localhost:30080
  â”‚       â€¢ GitHub Actions runner active in repo
  â”‚
  â”œâ”€â”€ Part 5: Security Scanning & Vulnerability Analysis
  â”‚   â”œâ”€â”€ Using Slash Command: /security-scan-inclusive-pipeline
  â”‚   â”‚
  â”‚   â”œâ”€â”€ PHASE 1: Setup Enhanced Security Pipeline
  â”‚   â”‚   â€¢ Archives existing pipeline to workflows-archive/
  â”‚   â”‚   â€¢ Creates enhanced pipeline with 9 security stages:
  â”‚   â”‚     - Stage 1: Lint
  â”‚   â”‚     - Stage 2: SAST + Secret Detection + Tests (parallel)
  â”‚   â”‚     - Stage 3: Security Scan (npm audit, RetireJS, Gitleaks, Dockerfile Policy)
  â”‚   â”‚     - Stage 4: SonarQube Analysis (manual gate)
  â”‚   â”‚     - Stage 5: Build Docker Image
  â”‚   â”‚     - Stage 5b: Trivy Container Scan (security gate)
  â”‚   â”‚     - Stage 6: Push to Docker Hub
  â”‚   â”‚     - Stage 7: Deploy to K8s
  â”‚   â”‚     - Stage 8: K8s Security (OWASP ZAP, Security Headers)
  â”‚   â”‚     - Stage 9: Consolidate Security Reports
  â”‚   â”‚   â€¢ Trigger pipeline run
  â”‚   â”‚
  â”‚   â”œâ”€â”€ PHASE 2: Hands-On Vulnerability Exploitation (OWASP Top 10)
  â”‚   â”‚   â€¢ Introduction to OWASP Top 10
  â”‚   â”‚   â€¢ Lab 1: SQL Injection - Login bypass with ' OR 1=1--
  â”‚   â”‚   â€¢ Lab 2: XSS - Reflected and Stored XSS attacks
  â”‚   â”‚   â€¢ Lab 3: Broken Authentication - MD5 hashing, JWT manipulation
  â”‚   â”‚   â€¢ Lab 4: Broken Access Control - IDOR vulnerabilities
  â”‚   â”‚
  â”‚   â””â”€â”€ PHASE 3: Review Security Scan Results
  â”‚       â€¢ Download consolidated security reports from GitHub Actions
  â”‚       â€¢ Review how each vulnerability was detected:
  â”‚         - SQL Injection â†’ Detected by CodeQL (SAST), OWASP ZAP (DAST)
  â”‚         - XSS â†’ Detected by CodeQL (SAST), OWASP ZAP (DAST)
  â”‚         - Broken Auth â†’ Detected by CodeQL (SAST), npm audit (SCA)
  â”‚         - IDOR â†’ Detected by CodeQL (SAST), OWASP ZAP (DAST)
  â”‚       â€¢ Analyze security dashboard (security-dashboard.html)
  â”‚       â€¢ Compare SAST vs DAST coverage
  â”‚
  â”œâ”€â”€ Part 5B: Local Security Scanning (DAST)
  â”‚   â”œâ”€â”€ Using Slash Command: /dast-security-scan
  â”‚   â”‚
  â”‚   â”œâ”€â”€ SCAN 1: Security Headers Analysis
  â”‚   â”‚   â€¢ HTTP security header validation
  â”‚   â”‚   â€¢ Check for CSP, HSTS, X-Frame-Options, etc.
  â”‚   â”‚   â€¢ Report missing security headers
  â”‚   â”‚
  â”‚   â”œâ”€â”€ SCAN 2: OWASP ZAP Baseline Scan (DAST)
  â”‚   â”‚   â€¢ Dynamic vulnerability testing
  â”‚   â”‚   â€¢ Runtime security scanning
  â”‚   â”‚   â€¢ HTML report with 20-50+ findings
  â”‚   â”‚
  â”‚   â”œâ”€â”€ SCAN 3: OWASP Noir - Attack Surface Analysis (SAST)
  â”‚   â”‚   â€¢ Discover 600 API endpoints via static analysis
  â”‚   â”‚   â€¢ Map complete attack surface
  â”‚   â”‚   â€¢ Identify 8 risk categories (Admin, Payment, Auth, etc.)
  â”‚   â”‚
  â”‚   â””â”€â”€ HANDS-ON: Using Noir Results for Penetration Testing
  â”‚       â€¢ Review 600 discovered endpoints
  â”‚       â€¢ Manual testing of high-risk endpoints
  â”‚       â€¢ Cross-reference SAST (Noir) with DAST (ZAP) findings
  â”‚       â€¢ Comprehensive vulnerability assessment report
  â”‚
  â”œâ”€â”€ Part 6: Advanced Security Automation
  â”‚   â”œâ”€â”€ Using Agent: /owasp-top10-analyzer
  â”‚   â”œâ”€â”€ DEMO 1: Custom security agents with Claude
  â”‚   â”‚   â€¢ Automated vulnerability analysis
  â”‚   â”‚   â€¢ OWASP Top 10 compliance checking
  â”‚   â”‚   â€¢ Educational insights and remediation
  â”‚   â”œâ”€â”€ DEMO 2: Pre-commit security hooks
  â”‚   â”‚   â€¢ Secret detection before commits
  â”‚   â”‚   â€¢ Security-focused linting
  â”‚   â”‚   â€¢ Shift-left security approach
  â”‚   â””â”€â”€ DEMO 3: Continuous security monitoring
  â”‚       â€¢ Dependabot automation
  â”‚       â€¢ GitHub Advanced Security features
  â”‚       â€¢ CodeQL integration
  â”‚
  â”‚
  â””â”€â”€ Part 7: Wrap-up & Q&A
      â””â”€â”€ Pipeline evolution recap, resources, next steps



TRAINING KICK-OFF: CONTEXT SETUP (MANDATORY FOR ALL ATTENDEES)
===============================================================

Execute these 3 slash commands IN ORDER before starting the training:
  1. /init-context-files - Initialize context preservation system FIRST
  2. /doc-generator - Generate comprehensive project documentation
  3. /update-doc-refs - Update CLAUDE.md with the new documentation

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Initialize Context Preservation System                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command: /init-context-files /path/to/owasp-juice-shop

  What it does:
  - Creates /docs directory structure for session tracking
  - Sets up 5 context files: CURRENT_STATE.txt, SESSION_HANDOFF.txt,
    COMMANDS_LOG.txt, DECISIONS.txt, ISSUES.txt
  - Generates README.md with usage instructions

  Why execute first:
  - Establishes foundation for tracking training progress
  - Enables session continuity and knowledge preservation
  - Required by subsequent commands (creates /docs directory)



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Generate Project Documentation                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command: /doc-generator /path/to/owasp-juice-shop

  What it does:
  - Analyzes entire Juice Shop codebase
  - Generates comprehensive technical documentation (500-600 lines)
  - Covers: architecture, tech stack, commands, deployment, CI/CD
  - Creates /docs/owasp-juice-shop.txt

  Why execute second:
  - Requires /docs directory (created in Step 1)
  - Provides complete reference for attendees during training
  - Documents all commands, workflows, and architecture


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Update CLAUDE.md Documentation Index                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command: /update-doc-refs

  What it does:
  - Scans /docs directory for all .txt files
  - Updates CLAUDE.md "Documents To Refer" section
  - Creates numbered index of all documentation files
  - Ensures Claude Code CLI knows about all available docs

  Why execute:
  - Requires documentation files to exist (created in Steps 1 & 2)
  - Makes all docs discoverable by Claude Code CLI
  - Enables "Read /docs/..." commands during training

=



PART 2: CLAUDE CODE CLI - MEMORY, CONTEXT & AUTOMATION
================================================================================

Using Slash Commands: /update-session-handoff
Using Agent: /owasp-top10-analyzer

This section demonstrates Claude Code CLI's advanced capabilities for session
continuity, context management, and automated vulnerability analysis.

Learning Objectives:
  â€¢ Understand Claude Code CLI's context window and memory management
  â€¢ Learn how to preserve session state across multiple training sessions
  â€¢ Master automated session capture and handoff workflows
  â€¢ Practice vulnerability analysis using Claude's code understanding
  â€¢ Use Claude to analyze Juice Shop's intentional vulnerabilities


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEMO 1: Context Files & Memory Preservation                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Objective: Show how Claude Code maintains session memory using context files

Step 1.1: Show Context Preservation Files
------------------------------------------

  Command to run:
  ls -la /path/to/owasp-juice-shop/docs/

  Expected output:
  CURRENT_STATE.txt      - Current project status snapshot
  SESSION_HANDOFF.txt    - End-of-session summaries  
  COMMANDS_LOG.txt       - Successful commands library
  DECISIONS.txt          - Technical decisions and rationale
  ISSUES.txt             - Known problems and workarounds
  README.md              - Usage guide for context files

  Explain to attendees:
  - These files act as "external memory" for Claude Code CLI
  - Enable continuity between different training sessions
  - Provide complete project context without re-explaining
  - Auto-updated by /update-session-handoff command


Step 1.2: Interactive Context Reading Demo
-------------------------------------------

  Demo Command 1:
  "Claude, read /docs/CURRENT_STATE.txt and summarize what you understand 
   about our current progress."

  What Claude will do:
  - Read the entire CURRENT_STATE.txt file
  - Summarize completed work, in-progress tasks
  - Identify next steps and blockers
  - Show understanding of project context

  Demo Command 2:
  "Claude, read /docs/SESSION_HANDOFF.txt and tell me what we accomplished 
   in the last session."

  What Claude will do:
  - Read the most recent session entry
  - Summarize accomplishments from previous session
  - List files that were modified
  - Highlight any blockers or open questions


Step 1.3: Explain Context Window Capacity
------------------------------------------

  Key Points to Cover:
  
  âœ“ Context Window Size: ~200,000 tokens
    - Equivalent to ~500 pages of text
    - Can hold multiple files simultaneously
    - Remembers entire conversation history
  
  âœ“ Context Preservation Strategy:
    - Short-term: Current conversation in memory
    - Long-term: Context files preserve state
    - Cross-session: Read context files to restore memory
  


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEMO 2: Automated Session Capture with /update-session-handoff      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Objective: Show how Claude automatically captures and documents session work

Step 2.1: Explain the Command
------------------------------

  Slash Command: /update-session-handoff

  What it does automatically:
  âœ“ Analyzes entire conversation history from current session
  âœ“ Extracts all tasks worked on
  âœ“ Identifies files created/modified (via git status)
  âœ“ Logs successful commands executed
  âœ“ Documents technical decisions made
  âœ“ Tracks issues found or fixed
  âœ“ Determines next steps
  âœ“ Updates ALL context files (CURRENT_STATE, SESSION_HANDOFF, etc.)

  Key Feature: Fully autonomous - no manual note-taking required!





â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEMO 3: OWASP Top 10 Analysis with Security Agent â­ HANDS-ON       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Objective: Demonstrate automated security analysis using Claude's OWASP Top 10 Agent

Agent to Use: /owasp-top10-analyzer
Location: /Users/rupeshpanwar/.claude/agents/owasp-top10-analyzer.md


Demo 3.1: Full OWASP Top 10 Scan (Comprehensive Analysis)
----------------------------------------------------------

  Command:
  "Analyze this codebase for all OWASP Top 10 vulnerabilities with
   educational insights"

  Agent: /owasp-top10-analyzer

  What the agent will do:
  âœ“ Systematically analyze all 10 OWASP categories
  âœ“ Search for vulnerabilities in routes/, models/, lib/
  âœ“ Generate comprehensive security report
  âœ“ Provide CVSS scores for each finding
  âœ“ Map to CWE (Common Weakness Enumeration)
  âœ“ Include educational explanations
  âœ“ Suggest fixes with code examples

  Expected Report Structure:

  # OWASP Top 10 (2021) Analysis Report
  Project: OWASP Juice Shop
  Date: [Timestamp]
  Analyzed by: Claude Security Agent

  ## Summary Dashboard

  | OWASP Category             | Status | Findings | Severity |
  |----------------------------|--------|----------|----------|
  | A01: Broken Access Control | ğŸ”´ FAIL| 5        | High     |
  | A02: Cryptographic Failures| ğŸ”´ FAIL| 3        | Critical |
  | A03: Injection             | ğŸ”´ FAIL| 7        | Critical |
  | A04: Insecure Design       | ğŸŸ¡ WARN| 2        | Medium   |
  | A05: Security Config       | ğŸ”´ FAIL| 4        | High     |
  | A06: Vulnerable Components | ğŸŸ¡ WARN| 12       | Medium   |
  | A07: Auth Failures         | ğŸ”´ FAIL| 4        | High     |
  | A08: Data Integrity        | ğŸŸ¢ PASS| 0        | N/A      |
  | A09: Logging Failures      | ğŸŸ¡ WARN| 3        | Low      |
  | A10: SSRF                  | ğŸŸ¢ PASS| 0        | N/A      |

  Overall Security Grade: F (Critical)


Demo 3.2: Focus on Specific Vulnerability Category
---------------------------------------------------

  Command:
  "Analyze for A03 (Injection) vulnerabilities only in educational mode"

  Agent: /owasp-top10-analyzer

  What the agent will demonstrate:
  âœ“ Deep dive into Injection vulnerabilities
  âœ“ SQL Injection in routes/login.ts
  âœ“ Command Injection (if exists)
  âœ“ Template Injection patterns
  âœ“ Detailed exploitation scenarios
  âœ“ Step-by-step fix recommendations

  Expected Output Example:

  A03: INJECTION
  Status: VULNERABLE
  Findings: 7

  Example 1: SQL Injection in routes/login.ts:23
    Code: db.query('SELECT * FROM Users WHERE email = "' + email + '"')
    Issue: User input directly concatenated into SQL
    CVSS: 9.8 (Critical)
    CWE: CWE-89 (SQL Injection)

    Education: Never concatenate user input into SQL queries.
    Use parameterized queries or ORMs with input binding.

    Exploit: email = admin' OR '1'='1
    Fix: db.query('SELECT * FROM Users WHERE email = ?', [email])



================================================================================

PART 3: DEPLOY SIMPLE PIPELINE FIRST!
================================================================================

Using Slash Command: /simple-pipeline-setup

Philosophy: Get it working before adding complexity

Execute slash command to build 4-stage CI/CD pipeline:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Create Basic 3-Stage Pipeline                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command: /simple-pipeline-setup

  What it does:
  - Analyzes your repository structure
  - Creates .github/workflows/simple-pipeline.yml
  - Sets up 3 stages: Lint â†’ Test â†’ Build
  - Uses yamllint for YAML validation
  - Uses npm run lint for code quality
  - Uses npm test for automated testing
  - Builds Docker image

  Stage 1: Lint
    â€¢ yamllint for configuration files
    â€¢ npm run lint for JavaScript/TypeScript

  Stage 2: Test
    â€¢ npm test (runs full test suite)
    â€¢ Depends on lint passing

  Stage 3: Build
    â€¢ docker build to create image
    â€¢ Depends on tests passing



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Extend with Docker Hub Push Stage                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command continues to:
  - Add Docker Hub integration
  - Configure secrets (DOCKER_USERNAME, DOCKER_TOKEN)
  - Add Stage 4: Push to Docker Hub
  - Set up job dependencies (needs: [build])

  Stage 4: Push to Docker Hub
    â€¢ Login to Docker Hub
    â€¢ Tag image with latest
    â€¢ Push to registry
    â€¢ Only runs on main branch



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Commit and Test Pipeline                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Trainee actions:
  - git add .github/workflows/simple-pipeline.yml
  - git commit -m "Add 4-stage CI pipeline"
  - git push origin main

  Verify in GitHub:
  - Navigate to Actions tab
  - Watch pipeline execute: lint â†’ test â†’ build â†’ push
  - Verify Docker image on Docker Hub



SUCCESS CRITERIA
================
âœ… 4-stage pipeline created and running
âœ… All stages passing (green checks)
âœ… Docker image pushed to Docker Hub
âœ… Understanding of job dependencies
âœ… Pipeline triggers on every push to main

Output: Docker image at dockerhub.com/r/<username>/owasp-juice-shop:latest


PART 4: LOCAL K8S CLUSTER WITH KIND + AUTOMATED DEPLOYMENT
================================================================================

Using Slash Commands: /kind-k8s-setup & /deploy-app-to-k8s-cluster

Build production-like local K8s environment with automated deployments

Execute slash commands to create cluster and deploy application:


PHASE 1: CLUSTER SETUP
================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1-11: Create 3-Node Kind Cluster                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command: /kind-k8s-setup

  What it does automatically:
  - Detects OS (macOS/Linux/Windows)
  - Installs Kind CLI
  - Installs kubectl CLI
  - Creates kind-k8s-cluster/kind-cluster-config.yaml
  - Creates 3-node cluster (1 control plane + 2 workers)
  - Configures port mappings (30080, 30443)
  - Deploys Kube-ops-view for monitoring
  - Sets up port forwarding (localhost:8080)
  - Validates cluster health
  - Tests with sample deployment
  - Generates kind-k8s-cluster/kind-cluster-info.txt

  Cluster Configuration:
  â€¢ Name: devsecops-cluster
  â€¢ Nodes: 3 (1 control plane + 2 workers)
  â€¢ K8s version: v1.27.3
  â€¢ Monitoring: http://localhost:8080 (Kube-ops-view)
  â€¢ Port mappings: localhost:30080 â†’ NodePort 30080
                   localhost:30443 â†’ NodePort 30443

  Verification commands:
  â€¢ kubectl get nodes (should show 3 nodes Ready)
  â€¢ kubectl get pods -A (all system pods Running)
  â€¢ Open browser: http://localhost:8080 (cluster visualization)



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 12-15: Deploy GitHub Actions Runner (OPTIONAL)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command continues to:
  - Guide GitHub PAT creation (repo + workflow scopes)
  - Create K8s secret with credentials
  - Deploy runner pod to cluster
  - Verify runner registration in GitHub

  What it creates:
  â€¢ Kubernetes secret: github-runner-secret
  â€¢ Runner deployment: kind-k8s-cluster/github-runner.yaml
  â€¢ ServiceAccount with RBAC permissions
  â€¢ Runner pod with kubectl access

  Verification:
  â€¢ kubectl get pods -l app=github-runner (Running)
  â€¢ Check GitHub: Settings â†’ Actions â†’ Runners
  â€¢ See: kind-cluster-runner (ğŸŸ¢ Idle)



PHASE 2: INTELLIGENT DEPLOYMENT
=========================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1-8: Deploy Application with Auto-Detection                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command: /deploy-app-to-k8s-cluster

  Auto-detects:
  âœ… Docker image from .github/workflows/*.yml
  âœ… Container port from Dockerfile (EXPOSE)
  âœ… Kind cluster and configuration
  âœ… Available NodePorts from kind-cluster-config.yaml
  âœ… Self-hosted runner usage

  Asks only:
  â“ Number of replicas (default: 1)
  â“ Resource limits (default: 512Mi RAM, 0.5 CPU)

  What it does:
  - Creates k8s/juice-shop-deployment.yaml
  - Creates k8s/juice-shop-service.yaml (NodePort 30080)
  - Deploys to cluster: kubectl apply -f k8s/
  - Waits for rollout: kubectl rollout status
  - Extends GitHub Actions workflow with deploy stage
  - Adds kubectl auto-installation step (prevents exit 127)
  - Creates deployment documentation

  Intelligent Features:
  â€¢ Only suggests NodePorts from Kind config (not 30000!)
  â€¢ Auto-installs kubectl on self-hosted runners
  â€¢ Detects and reuses pipeline variables
  â€¢ Adds proper job dependencies (needs: [push-to-dockerhub])

  Stage 5: Deploy to K8s
    â€¢ Checkout code
    â€¢ Install kubectl (if not present)
    â€¢ Apply K8s manifests
    â€¢ Update deployment image
    â€¢ Wait for rollout completion



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TEST: End-to-End CI/CD Pipeline                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Trainee actions:
  - Make code change
  - git commit and push
  - Watch full pipeline: lint â†’ test â†’ build â†’ push â†’ deploy

  Pipeline Flow:
  Developer commits code
         â†“
  GitHub Actions triggered
         â†“
  Stage 1: Lint (yamllint, npm lint)
         â†“
  Stage 2: Test (npm test)
         â†“
  Stage 3: Build (docker build)
         â†“
  Stage 4: Push (Docker Hub)
         â†“
  Stage 5: Deploy (kubectl to Kind) â˜… NEW
         â†“
  App updated: http://localhost:30080



SUCCESS CRITERIA
================
âœ… 3-node Kind cluster running
âœ… Kube-ops-view accessible at http://localhost:8080
âœ… GitHub Actions runner registered and active
âœ… Juice Shop deployed at http://localhost:30080
âœ… 5-stage pipeline: lint â†’ test â†’ build â†’ push â†’ deploy
âœ… Auto-deployment on every git push
âœ… kubectl auto-installs on runner (no exit 127 errors)
âœ… NodePort matches Kind config (30080, not 30000)



PART 5: SECURITY SCANNING & VULNERABILITY ANALYSIS
================================================================================

Using Slash Command: /security-scan-inclusive-pipeline

Complete security workflow: Setup Pipeline â†’ Exploit Vulnerabilities â†’ Review Detections


PHASE 1: SETUP ENHANCED SECURITY PIPELINE
==========================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Run Security Scan Pipeline Setup                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command: /security-scan-inclusive-pipeline

  What it does:
  - Reads docs/juice-shop-app.txt for project analysis
  - Detects technology stack (Node.js, Angular, Docker, K8s)
  - Finds existing pipeline (.github/workflows/simple-pipeline.yml)
  - Archives existing pipeline to .github/workflows-archive/
  - Creates .github/workflows/enhanced-pipeline.yml



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Review Enhanced Pipeline Structure                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Pipeline Transformation:

  Before (Simple Pipeline):
  Lint â†’ Test â†’ Build â†’ Push â†’ Deploy (5 stages)

  After (Enhanced with Security - 9 stages):
  Stage 1: Lint
  Stage 2: SAST + Secret Detection + Tests (parallel)
  Stage 3: Security Scan (npm-audit, RetireJS, Gitleaks, Dockerfile Policy)
  Stage 4: SonarQube Analysis (manual gate)
  Stage 5: Build Docker Image
  Stage 5b: Trivy Container Scan (security gate before push)
  Stage 6: Push to Docker Hub
  Stage 7: Deploy to K8s
  Stage 8: K8s Security (DAST with OWASP ZAP, Security Headers)
  Stage 9: Consolidate Security Reports

  Security Tools Integrated:

  SAST (Static Analysis):
  â€¢ CodeQL - Code security scanning
  â€¢ npm audit - Dependency vulnerabilities

  Secret Detection:
  â€¢ TruffleHog - Git history secret scanning
  â€¢ Gitleaks - Comprehensive secret detection

  SCA (Software Composition Analysis):
  â€¢ npm audit - Known vulnerable dependencies
  â€¢ RetireJS - JavaScript library vulnerabilities

  Container Security:
  â€¢ Trivy - Container image scanning (OS packages, app dependencies)

  Policy as Code:
  â€¢ OPA/Conftest - Dockerfile security policies
  â€¢ K8s manifest security validation

  DAST (Dynamic Analysis):
  â€¢ OWASP ZAP - Runtime vulnerability scanning
  â€¢ Security Headers - HTTP header analysis

  Code Quality:
  â€¢ SonarQube - Code quality + security (manual gate)



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Trigger Enhanced Pipeline                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Trainee actions:
  - git add .github/workflows/enhanced-pipeline.yml
  - git commit -m "Add security scanning to pipeline"
  - git push origin main

  Watch in GitHub Actions:
  - All 9 stages execute
  - Security scans run in parallel (Stage 2 & 3)
  - Vulnerabilities detected (expected for Juice Shop)
  - Pipeline completes (warning mode)
  - Consolidated report generated

  Note: Pipeline runs in background while we continue with labs



PHASE 2: HANDS-ON VULNERABILITY EXPLOITATION
=============================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Introduction to OWASP Top 10                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Trainer Overview:
  - OWASP Top 10: Most critical web application security risks
  - Focus on 4 vulnerability classes in this training:
    â€¢ A03: Injection (SQL Injection)
    â€¢ A07: Identification and Authentication Failures (Broken Auth)
    â€¢ A01: Broken Access Control (IDOR)
    â€¢ A03: Injection (XSS - Cross-Site Scripting)

  Access Juice Shop:
  - http://localhost:30080
  - Intentionally vulnerable for training
  - 100+ security challenges built-in



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAB 1: SQL Injection - Login Bypass                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Exploit:
  1. Open http://localhost:30080/#/login
  2. Email field: admin' OR '1'='1'--
  3. Password: anything
  4. Click Login
  5. Result: Logged in as admin without knowing password

  What happened:
  - SQL query: SELECT * FROM Users WHERE email='admin' OR '1'='1'--' AND password='...'
  - OR '1'='1' always true
  - -- comments out password check
  - Authentication bypassed

  Detection (we'll verify in Phase 3):
  - SAST: CodeQL detects SQL injection in code
  - DAST: OWASP ZAP detects during runtime testing



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAB 2: XSS - Cross-Site Scripting                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Reflected XSS:
  1. Search box: <script>alert('XSS')</script>
  2. Result: Popup appears (script executed)

  Stored XSS:
  1. Navigate to Product Reviews
  2. Review text: <iframe src="javascript:alert('XSS')">
  3. Submit review
  4. Result: Every user sees the XSS payload

  What happened:
  - User input not sanitized
  - HTML/JavaScript rendered directly in browser
  - Can steal cookies, session tokens

  Detection (we'll verify in Phase 3):
  - SAST: CodeQL detects unsafe HTML rendering
  - DAST: OWASP ZAP tests XSS payloads



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAB 3: Broken Authentication - MD5 Hashing, JWT                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  MD5 Hash Weakness:
  - Juice Shop uses MD5 for password hashing
  - MD5 is cryptographically broken
  - Rainbow tables can crack MD5 hashes

  JWT Token Manipulation:
  1. Login to Juice Shop
  2. Open Browser DevTools â†’ Application â†’ Cookies
  3. Find JWT token
  4. Decode on jwt.io
  5. Modify payload (e.g., change role)
  6. Re-sign with weak secret (0 stars rating challenge)

  Detection (we'll verify in Phase 3):
  - SAST: CodeQL detects weak crypto (MD5)
  - SCA: npm audit flags old jsonwebtoken library



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAB 4: Broken Access Control - IDOR                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Insecure Direct Object Reference (IDOR):
  1. Login as any user
  2. Access basket: http://localhost:30080/rest/basket/1
  3. Change ID to 2: http://localhost:30080/rest/basket/2
  4. Result: View another user's shopping basket

  What happened:
  - No authorization check on basket ID
  - Can access any user's data by changing ID
  - Common in APIs with sequential IDs

  Detection (we'll verify in Phase 3):
  - SAST: CodeQL detects missing authorization checks
  - DAST: OWASP ZAP tests IDOR patterns



PHASE 3: REVIEW SECURITY SCAN RESULTS
======================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Download Consolidated Security Reports                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Access Reports:
  1. Navigate to GitHub Actions
  2. Click on latest workflow run
  3. Scroll to Artifacts section
  4. Download: consolidated-security-reports.zip
  5. Extract and open: security-dashboard.html



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Verify Vulnerability Detections                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Review security-dashboard.html:

  SQL Injection:
  - âœ… CodeQL (SAST): Found SQL injection in routes/login.ts
  - âœ… OWASP ZAP (DAST): Detected injectable parameters
  - Severity: Critical (CVSS 9.8)

  XSS (Cross-Site Scripting):
  - âœ… CodeQL (SAST): Unsafe HTML rendering detected
  - âœ… OWASP ZAP (DAST): XSS payloads successfully injected
  - Severity: High (CVSS 7.5)

  Broken Authentication:
  - âœ… CodeQL (SAST): MD5 hashing detected (weak crypto)
  - âœ… npm audit (SCA): Old jsonwebtoken library flagged
  - Severity: High (CVSS 7.0)

  Broken Access Control (IDOR):
  - âœ… CodeQL (SAST): Missing authorization checks
  - âœ… OWASP ZAP (DAST): IDOR patterns detected
  - Severity: High (CVSS 7.0)



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Compare SAST vs DAST Coverage                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  SAST (Static Analysis) - Code Review:
  Strengths:
  - Finds vulnerabilities early (before deployment)
  - Can identify all code paths
  - No need for running application
  - Low false positives for known patterns

  Limitations:
  - Cannot detect runtime-only issues
  - May miss configuration vulnerabilities
  - Context-dependent issues harder to find

  DAST (Dynamic Analysis) - Runtime Testing:
  Strengths:
  - Tests actual running application
  - Finds configuration issues
  - Detects authentication/session problems
  - Real-world attack simulation

  Limitations:
  - Requires deployed application
  - Cannot test all code paths
  - Higher false positives
  - Slower execution



SUCCESS CRITERIA
================
âœ… Enhanced security pipeline created and running
âœ… Understand OWASP Top 10 concepts
âœ… Successfully exploit 4 vulnerability types
âœ… Verify security tools detected exploited vulnerabilities
âœ… Understand SAST vs DAST coverage differences
âœ… Appreciate layered security approach (multiple tools)
âœ… Review consolidated security dashboard


PART 5B: LOCAL SECURITY SCANNING (DAST)
================================================================================

Using Slash Command: /dast-security-scan

Run comprehensive security scans locally against Juice Shop in Kind cluster

Execute slash command to perform 3 types of security analysis:


OVERVIEW
========

Local security scanning complements pipeline-based scanning by allowing:
â€¢ Immediate feedback without CI/CD wait times
â€¢ Testing against locally deployed applications
â€¢ Attack surface analysis using static code inspection
â€¢ Dynamic vulnerability testing with OWASP ZAP
â€¢ Security configuration validation

Prerequisite: Juice Shop deployed in Kind cluster (Part 4 completed)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCAN 1: Security Headers Analysis                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command: /dast-security-scan Security Headers

  What it does:
  - Detects application URL (localhost:30080 or Kind node IP)
  - Analyzes HTTP response headers
  - Checks for security headers:
    â€¢ X-Content-Type-Options (prevents MIME sniffing)
    â€¢ X-Frame-Options (clickjacking protection)
    â€¢ Content-Security-Policy (XSS mitigation)
    â€¢ Strict-Transport-Security (HTTPS enforcement)
    â€¢ X-XSS-Protection (browser XSS filter)

  Expected Findings:
  - âœ“ X-Content-Type-Options: Present (nosniff)
  - âœ“ X-Frame-Options: Present (SAMEORIGIN)
  - âœ— Content-Security-Policy: MISSING (intentional - allows XSS)
  - âœ— Strict-Transport-Security: MISSING (intentional - allows HTTP)
  - âœ— X-XSS-Protection: MISSING (intentional - vulnerable to XSS)

  Report Location: security-scan-reports/security-headers-scan.txt

  Learning Points:
  â€¢ Missing CSP header increases XSS attack surface
  â€¢ Missing HSTS allows man-in-the-middle attacks
  â€¢ Security headers are first line of browser-based defense



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCAN 2: OWASP ZAP Baseline Scan (DAST)                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command: /dast-security-scan OWASP ZAP

  What it does:
  - Runs OWASP ZAP in Docker container with --network host
  - Performs baseline DAST scan against localhost:30080
  - Tests for runtime vulnerabilities:
    â€¢ SQL Injection
    â€¢ XSS (Cross-Site Scripting)
    â€¢ CSRF (Cross-Site Request Forgery)
    â€¢ Security misconfigurations
    â€¢ Information disclosure
  - Generates HTML report with findings

  Expected Findings (20-50+ vulnerabilities):
  1. Cross-Domain JavaScript Source File Inclusion (12 instances)
  2. Content Security Policy (CSP) Header Not Set (11 instances)
  3. Cross-Domain Misconfiguration (13 instances)
  4. Information Disclosure - Suspicious Comments (2 instances)
  5. Dangerous JS Functions (2 instances)
  6. Insufficient Site Isolation Against Spectre (12 instances)

  Report Location: security-scan-reports/zap-reports/zap-report.html

  Learning Points:
  â€¢ DAST finds runtime vulnerabilities missed by SAST
  â€¢ Tests actual application behavior, not just code
  â€¢ Simulates real-world attacker perspective
  â€¢ Complements static analysis with dynamic testing

  Scan Duration: 2-5 minutes (plus Docker image download on first run)



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCAN 3: OWASP Noir - Attack Surface Analysis (SAST)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Command: /dast-security-scan OWASP Noir - Attack Surface Analysis

  What it does:
  - Static code analysis to discover API endpoints
  - Analyzes source code without running application
  - Detects technologies: Express.js, OpenAPI, Angular
  - Maps complete attack surface
  - Identifies hidden/undocumented endpoints

  Expected Findings:
  â€¢ Total Endpoints Discovered: 600
  â€¢ HTTP Method Distribution:
    - GET: 341 endpoints (56.8%)
    - POST: 80 endpoints (13.3%)
    - PUT: 78 endpoints (13.0%)
    - DELETE: 44 endpoints (7.3%)
    - PATCH: 20 endpoints (3.3%)
    - OPTIONS: 19 endpoints (3.2%)
    - HEAD: 18 endpoints (3.0%)
  â€¢ Source Files Analyzed: 124
  â€¢ Technologies: Express.js, OpenAPI Spec 3, Angular

  Attack Surface Categories Identified:
  1. Authentication & Authorization (HIGH RISK)
     â€¢ Login endpoints
     â€¢ Token generation/validation
     â€¢ 2FA endpoints
     â€¢ Session management

  2. User Management (MEDIUM RISK)
     â€¢ User profile CRUD
     â€¢ Password reset
     â€¢ Account deletion

  3. Product & Inventory (MEDIUM RISK)
     â€¢ Product listing/search
     â€¢ Price information
     â€¢ Inventory queries

  4. Shopping Cart & Orders (HIGH RISK)
     â€¢ Basket operations
     â€¢ Order placement
     â€¢ Payment processing

  5. Payment Processing (HIGH RISK)
     â€¢ Payment methods
     â€¢ Coupon/discount application
     â€¢ Transaction processing

  6. File Upload/Download (HIGH RISK)
     â€¢ Image uploads
     â€¢ File complaints
     â€¢ Avatar uploads

  7. Admin Functions (CRITICAL RISK)
     â€¢ Admin panel access
     â€¢ User management
     â€¢ Configuration changes

  8. API Operations (MEDIUM RISK)
     â€¢ REST API endpoints
     â€¢ OpenAPI documentation
     â€¢ Metrics endpoints

  Report Locations:
  - security-scan-reports/noir-scan.txt (summary)
  - security-scan-reports/noir-clean.json (machine-readable)
  - security-scan-reports/NOIR-ATTACK-SURFACE-REPORT.md (comprehensive)

  Learning Points:
  â€¢ Attack surface analysis reveals all entry points
  â€¢ Static analysis discovers endpoints without running app
  â€¢ 600 endpoints = 600 potential attack vectors
  â€¢ Helps prioritize penetration testing targets
  â€¢ Critical for threat modeling and risk assessment

  Scan Duration: 2-3 minutes



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CONSOLIDATED REPORT: Comprehensive Vulnerability Assessment                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  After all scans complete, the command generates:

  Report: security-scan-reports/JUICE-SHOP-VULNERABILITY-REPORT.md

  Includes:
  â€¢ Executive summary
  â€¢ Scan results from all 3 tools
  â€¢ Combined risk assessment
  â€¢ OWASP Top 10 2021 mapping
  â€¢ Testing methodology
  â€¢ Remediation recommendations
  â€¢ Compliance considerations (PCI DSS, GDPR, SOC 2)
  â€¢ Next steps for security testing

  Key Sections:
  1. Security Headers Analysis Results
  2. OWASP ZAP DAST Findings (with severity ratings)
  3. OWASP Noir Attack Surface (600 endpoints categorized)
  4. Combined Risk Priorities (Critical/High/Medium/Low)
  5. Comparison: SAST vs DAST coverage
  6. Recommendations for production deployments



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HANDS-ON: Using Noir Results for Penetration Testing                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Trainee Exercise:

  Step 1: Review Discovered Endpoints
  -----------------------------------
  Open: security-scan-reports/noir-clean.json
  - Browse all 600 discovered endpoints
  - Identify high-value targets (admin, payment, auth)
  - Note endpoints with parameters

  Step 2: Manual Testing High-Risk Endpoints
  ------------------------------------------
  Using discovered endpoints, test for:

  Example 1: Admin Endpoints (CRITICAL)
  - Endpoint: /rest/admin/*
  - Test: Access without authentication
  - Test: Attempt privilege escalation
  - Expected: Should require admin role

  Example 2: Basket Operations (HIGH RISK - IDOR)
  - Endpoint: /rest/basket/[id]
  - Test: Change ID parameter (1, 2, 3, etc.)
  - Test: Access other users' baskets
  - Expected: Should detect IDOR vulnerability

  Example 3: Payment Processing (HIGH RISK)
  - Endpoint: /api/Payment
  - Test: Manipulate amount parameters
  - Test: Apply invalid coupons
  - Expected: Business logic vulnerabilities

  Example 4: File Upload (HIGH RISK)
  - Endpoint: /file-upload
  - Test: Upload malicious files (.php, .jsp, .exe)
  - Test: Path traversal in filenames
  - Expected: Insufficient validation

  Step 3: Cross-Reference with ZAP Findings
  ------------------------------------------
  - Compare Noir endpoints with ZAP scan results
  - Identify endpoints flagged by both tools
  - Prioritize testing endpoints with high severity
  - Document findings for remediation



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COMPARISON: Pipeline Scans vs Local Scans                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Pipeline-Based Scanning (Part 5):
  âœ“ Automated on every commit
  âœ“ Integrated in CI/CD workflow
  âœ“ Security gates prevent bad deployments
  âœ“ Consolidated reports in GitHub Artifacts
  âœ“ Team visibility and audit trail

  Local Security Scanning (Part 5B):
  âœ“ Immediate feedback (no CI/CD wait)
  âœ“ Pre-commit validation
  âœ“ Developer-friendly workflow
  âœ“ Testing against local deployments
  âœ“ Detailed attack surface analysis

  Best Practice: Use BOTH!
  â€¢ Local scans during development
  â€¢ Pipeline scans for enforcement
  â€¢ Complete coverage with layered approach



SUCCESS CRITERIA
================
âœ… Run all 3 local security scans successfully
âœ… Understand Security Headers and their importance
âœ… Review OWASP ZAP HTML report with vulnerability findings
âœ… Analyze OWASP Noir's 600 discovered endpoints
âœ… Identify attack surface categories (Admin, Payment, Auth, etc.)
âœ… Use Noir results for targeted penetration testing
âœ… Cross-reference findings between SAST (Noir) and DAST (ZAP)
âœ… Review consolidated vulnerability assessment report
âœ… Understand difference between pipeline and local scanning
âœ… Appreciate value of attack surface analysis



PART 6: ADVANCED SECURITY AUTOMATION
================================================================================

Using Agent: /owasp-top10-analyzer

Automate security workflows with custom agents and hooks


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEMO 1: Custom Security Agents with Claude                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Using: /owasp-top10-analyzer agent (from Part 2)

  What it does:
  - Automated vulnerability analysis
  - OWASP Top 10 compliance checking
  - Educational insights for each finding
  - CVSS scoring and CWE mapping
  - Remediation recommendations

  Demo Scenarios:

  Scenario 1: Full OWASP Top 10 Scan
  Command: "Analyze this codebase for all OWASP Top 10 vulnerabilities"
  Result: Comprehensive security dashboard with all 10 categories

  Scenario 2: Focused Analysis
  Command: "Analyze for A03 (Injection) vulnerabilities only"
  Result: Deep dive into SQL injection, XSS, command injection

  Use Cases:
  - Pre-commit security audit
  - Code review automation
  - Security training material generation
  - Compliance reporting



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEMO 2: Pre-commit Security Hooks                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Concept: Shift-left security (catch issues before commit)

  Tools demonstrated:

  1. Secret Detection (pre-commit)
     - Gitleaks hook prevents committing secrets
     - Scans staged files before commit
     - Blocks commit if secrets found

  2. Security-focused Linting
     - ESLint security plugins
     - Detect unsafe patterns (eval, innerHTML)
     - Enforce secure coding practices

  3. Automated Security Tests
     - Run unit tests with security focus
     - API security test suite
     - Fail commit if security tests fail

  Implementation (demonstration only):
  - .git/hooks/pre-commit script
  - Runs Gitleaks on staged files
  - Runs security linters
  - Blocks commit on critical findings



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEMO 3: Continuous Security Monitoring                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  GitHub Advanced Security Features:

  1. Dependabot:
     - Automated dependency updates
     - Security vulnerability alerts
     - Automatic pull requests for patches

  2. Code Scanning (CodeQL):
     - Continuous SAST scanning
     - Integration with GitHub Security tab
     - Pull request annotations

  3. Secret Scanning:
     - GitHub detects pushed secrets
     - Alerts repository admins
     - Partner pattern detection (AWS, Azure, etc.)

  4. Security Advisories:
     - Private vulnerability reporting
     - CVSS scoring
     - Coordinated disclosure

  Configuration (demonstration):
  - Settings â†’ Security & Analysis
  - Enable Dependabot alerts
  - Enable Dependabot security updates
  - Enable CodeQL analysis
  - Enable Secret scanning



SUCCESS CRITERIA
================
âœ… Understand custom security agent capabilities
âœ… See pre-commit hook demonstration
âœ… Learn GitHub Advanced Security features
âœ… Appreciate shift-left security approach
âœ… Understand continuous monitoring concepts


QUICK REFERENCE: SECURITY TOOLS SUMMARY
========================================

SAST (Static Analysis):
  CodeQL        - Multi-language code scanning
  Semgrep       - Pattern-based security rules

SCA (Composition Analysis):
  npm audit     - Node.js dependency scanning
  RetireJS      - JavaScript library vulnerabilities

Secret Detection:
  TruffleHog    - Git history secret scanning
  Gitleaks      - Comprehensive secret detection
  detect-secrets- Pre-commit secret prevention

Container Security:
  Trivy         - Container image vulnerability scanner
  Grype         - Alternative container scanner

Policy as Code:
  OPA/Conftest  - Dockerfile and K8s policy validation
  KubeSec       - K8s manifest security scoring

DAST (Dynamic Analysis):
  OWASP ZAP     - Web application security scanner
  Burp Suite    - Manual security testing

Attack Surface Analysis:
  OWASP Noir    - API endpoint discovery via static analysis
                  Discovers 600+ endpoints, maps attack surface

Code Quality:
  SonarQube     - Code quality + security analysis


TRAINING RESOURCES
==================

OWASP Juice Shop:
  - Challenges: http://localhost:30080/#/score-board
  - Documentation: https://pwning.owasp-juice.shop
  - 100+ challenges across OWASP Top 10

Security Scan Reports:
  - GitHub Actions â†’ Artifacts â†’ consolidated-security-reports
  - security-dashboard.html (interactive dashboard)
  - security-report.md (GitHub-friendly summary)

Claude Code CLI:
  - /owasp-top10-analyzer - Automated vulnerability analysis
  - /security-scan-inclusive-pipeline - Security pipeline setup
  - /dast-security-scan - Local security scanning (Headers, ZAP, Noir)
  - Agent-based security automation

Local Security Scan Reports:
  - security-scan-reports/security-headers-scan.txt
  - security-scan-reports/zap-reports/zap-report.html
  - security-scan-reports/NOIR-ATTACK-SURFACE-REPORT.md
  - security-scan-reports/JUICE-SHOP-VULNERABILITY-REPORT.md

